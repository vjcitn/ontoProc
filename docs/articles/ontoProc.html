<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ontoProc: Ontology interfaces for Bioconductor, with focus on cell type identification • ontoProc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ontoProc: Ontology interfaces for Bioconductor, with focus on cell type identification">
<meta property="og:description" content="ontoProc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ontoProc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.21.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/ontoProc.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vjcitn/ontoProc/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ontoProc: Ontology interfaces for Bioconductor, with focus on cell type identification</h1>
                        <h4 data-toc-skip class="author">Vincent J. Carey, stvjc at channing.harvard.edu</h4>
            
            <h4 data-toc-skip class="date">April 19, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vjcitn/ontoProc/blob/HEAD/vignettes/ontoProc.Rmd"><code>vignettes/ontoProc.Rmd</code></a></small>
      <div class="hidden name"><code>ontoProc.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The ambitions of collaborative single cell biology will only be achieved through the coordinated efforts of many groups, to help clarify cell types and dynamics in an array of functional and environmental contexts. The use of formal ontology in this pursuit is well-motivated and research progress has already been substantial.</p>
<p><span class="citation">Bakken et al. (2017)</span> discuss “strategies for standardized cell type representations based on the data outputs from [high-content flow cytometry and single cell RNA sequencing], including ‘context annotations’ in the form of standardized experiment metadata about the specimen source analyzed and marker genes that serve as the most useful features in machine learning-based cell type classification models.” <span class="citation">Aevermann et al. (2018)</span> describe how the FAIR principles can be implemented using statistical identification of necessary and sufficient conditions for determining cell class membership. They propose that Cell Ontology can be transformed to a broadly usable knowledgebase through the incorporation of accurate marker gene signatures for cell classes.</p>
<p>In this vignette, we review key concepts and tasks required to make progress in the adoption and application of ontological discipline in Bioconductor-oriented data analysis.</p>
<p>We’ll start by setting up some package attachments and ontology objects.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vjcitn/ontoProc">ontoProc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ontologyPlot</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocStyle" class="external-link">BiocStyle</a></span><span class="op">)</span>  <span class="co"># for package references</span></span>
<span><span class="va">cl</span> <span class="op">=</span> <span class="fu"><a href="../reference/getOnto.html">getOnto</a></span><span class="op">(</span><span class="st">"cellOnto"</span>, <span class="st">"2023"</span><span class="op">)</span> <span class="co"># for continuity --    has_high_plasma_membrane_amount: list</span></span>
<span><span class="va">go</span> <span class="op">=</span> <span class="fu"><a href="../reference/getOnto.html">getOnto</a></span><span class="op">(</span><span class="st">"goOnto"</span>, <span class="st">"2023"</span><span class="op">)</span>  <span class="co"># if updated, some assertions will fail...</span></span>
<span><span class="va">pr</span> <span class="op">=</span> <span class="fu"><a href="../reference/getOnto.html">getOnto</a></span><span class="op">(</span><span class="st">"PROnto"</span>, <span class="st">"2023"</span><span class="op">)</span>  <span class="co"># important case change</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="scope-of-package">Scope of package<a class="anchor" aria-label="anchor" href="#scope-of-package"></a>
</h2>
<p>The following table describes the most up-to-date resources available with <code>getOnto</code>. <!-- use inst/scripts/desc.R to generate all but the 'purpose' which is added by hand --></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">packDesc2023</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">packDesc2023</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">name</th>
<th align="right">nclass</th>
<th align="right">nprop</th>
<th align="right">nroots</th>
<th align="left">datav</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">caro</td>
<td align="right">751</td>
<td align="right">57</td>
<td align="right">30</td>
<td align="left">caro/releases/2022-02-18/caro-full.owl</td>
</tr>
<tr class="even">
<td align="left">cellLineOnto</td>
<td align="right">43596</td>
<td align="right">204</td>
<td align="right">110</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">cellOnto</td>
<td align="right">17371</td>
<td align="right">229</td>
<td align="right">102</td>
<td align="left">releases/2023-02-15</td>
</tr>
<tr class="even">
<td align="left">cellosaurus</td>
<td align="right">144570</td>
<td align="right">NA</td>
<td align="right">144571</td>
<td align="left">44.0</td>
</tr>
<tr class="odd">
<td align="left">chebi_full</td>
<td align="right">163735</td>
<td align="right">34</td>
<td align="right">13</td>
<td align="left">218</td>
</tr>
<tr class="even">
<td align="left">chebi_lite</td>
<td align="right">163735</td>
<td align="right">32</td>
<td align="right">13</td>
<td align="left">218</td>
</tr>
<tr class="odd">
<td align="left">diseaseOnto</td>
<td align="right">13680</td>
<td align="right">26</td>
<td align="right">3</td>
<td align="left">doid/releases/2023-01-30/doid-non-classified.obo</td>
</tr>
<tr class="even">
<td align="left">efoOnto</td>
<td align="right">40514</td>
<td align="right">93</td>
<td align="right">60</td>
<td align="left"><a href="http://www.ebi.ac.uk/efo/releases/v3.51.0/efo.owl" class="external-link uri">http://www.ebi.ac.uk/efo/releases/v3.51.0/efo.owl</a></td>
</tr>
<tr class="odd">
<td align="left">goOnto</td>
<td align="right">47427</td>
<td align="right">41</td>
<td align="right">10</td>
<td align="left">releases/2023-01-01</td>
</tr>
<tr class="even">
<td align="left">hcaoOnto</td>
<td align="right">22821</td>
<td align="right">259</td>
<td align="right">161</td>
<td align="left">releases/2022-12-16/hcao.owl</td>
</tr>
<tr class="odd">
<td align="left">mondo</td>
<td align="right">44707</td>
<td align="right">249</td>
<td align="right">116</td>
<td align="left">releases/2022-08-01</td>
</tr>
<tr class="even">
<td align="left">patoOnto</td>
<td align="right">2813</td>
<td align="right">45</td>
<td align="right">16</td>
<td align="left">releases/2022-12-15/pato.obo</td>
</tr>
<tr class="odd">
<td align="left">PROnto</td>
<td align="right">334873</td>
<td align="right">48</td>
<td align="right">49</td>
<td align="left">68.0</td>
</tr>
<tr class="even">
<td align="left">uberon</td>
<td align="right">25836</td>
<td align="right">245</td>
<td align="right">138</td>
<td align="left">releases/2023-02-14</td>
</tr>
<tr class="odd">
<td align="left">Pronto</td>
<td align="right">315957</td>
<td align="right">6</td>
<td align="right">53</td>
<td align="left">57.0</td>
</tr>
</tbody>
</table>
<p>Other resources are listed in <code>packDesc202x</code> and <code>packDesc2019</code>.</p>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<div class="section level3">
<h3 id="conceptual-overview-of-ontology-with-cell-types">Conceptual overview of ontology with cell types<a class="anchor" aria-label="anchor" href="#conceptual-overview-of-ontology-with-cell-types"></a>
</h3>
<p><strong>Definitions, semantics.</strong> For concreteness, we provide some definitions and examples. We use <code>ontology</code> to denote the systematic organization of terminology used in a conceptual domain. The <code>Cell Ontology</code> is a graphical data structure with carefully annotated terms as nodes and conventionally defined semantic relationships among terms serving as edges. As an example, <code>lung ciliated cell</code> has URI . This URI includes a fixed-length identifier <code>CL_1000271</code> with unambiguous interpretation wherever it is encountered. There is a chain of relationships from <code>lung ciliated cell</code> up through <code>ciliated cell</code>, then <code>native cell</code>, then <code>cell</code>, each possessing its own URI and related interpretive metadata. The relationship connecting the more precise to the less precise term in this chain is denoted <code>SubclassOf</code>. <code>Ciliated cell</code> is equivalent to a <code>native cell</code> that <code>has plasma membrane part</code> <code>cilium</code>. Semantic characteristics of terms and relationships are used to infer relationships among terms that may not have relations directly specified in available ontologies.</p>
<p><strong>Barriers to broad adoption.</strong> Given the wealth of material available in biological ontologies, it is somewhat surprising that formal annotation is so seldom used in practice. Barriers to more common use of ontology in data annotation include: (i) Non-existence of exact matching between intended term and terms available in ontologies of interest. (ii) The practical problem of decoding ontology identifiers. A GO tag or CL tag is excellent for programming, but it is clumsy to co-locate with the tag the associated natural language term or phrase. (iii) Likelihood of disagreement of suitability of terms for conditions observed at the boundaries of knowledge. To help cope with the first of these problems, Bioconductor’s <code>ontologyProc</code> package includes a function <code>liberalMap</code> which will search an ontology for terms lexically close to some target term or phrase. The second problem can be addressed with more elaborate data structures for variable annotation and programming in R, and the third problem will diminish in importance as the value of ontology adoption becomes manifest in more applications.</p>
<p><strong>Class vs. instance.</strong> It is important to distinguish the practice of designing and maintaining ontologies from the use of ontological class terms to annotate instances of the concepts. The combination of an ontology and a set of annotated instances is called a knowledge base. To illustrate some of the salient distinctions here, consider the cell line called A549, which is established from a human lung adenocarcinoma sample. There is no mention of A549 in the Cell Ontology. However, A549 is present in the EBI Experimental Factor Ontology as a subclass of the “Homo sapiens cell line” class. Presumably this is because A549 is a class of cells that are widely used experimentally, and this cell line constitutes a concept deserving of mapping in the universe of experimental factors. In the universe of concepts related to cell structure and function <em>per se</em>, A549 is an individual that can be characterized through possession of or lack of properties enumerated in Cell Ontology, but it is not deserving of inclusion in that ontology.</p>
</div>
<div class="section level3">
<h3 id="illustration-in-a-single-cell-rna-seq-dataset">Illustration in a single-cell RNA-seq dataset<a class="anchor" aria-label="anchor" href="#illustration-in-a-single-cell-rna-seq-dataset"></a>
</h3>
<p>The 10X Genomics corporation has distributed a dataset on results of sequencing 10000 PBMC from a healthy donor . Subsets of the data are used in tutorials for the Seurat analytical suite (<span class="citation">Butler et al. (2018)</span>).</p>
<div class="section level4">
<h4 id="labeling-pbmc-in-the-seurat-tutorial">Labeling PBMC in the Seurat tutorial<a class="anchor" aria-label="anchor" href="#labeling-pbmc-in-the-seurat-tutorial"></a>
</h4>
<p>One result of the tutorial analysis of the 3000 cell subset is a table of cell types and expression-based markers of cell identity. The first three columns of the table below are from concluding material in the Seurat tutorial; the remaining columns are created by “manual” matching between the Seurat terms and terms found in Cell Ontology.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kable</span><span class="op">(</span><span class="va">stab</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seur3kTab.html">seur3kTab</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">grp</th>
<th align="left">markers</th>
<th align="left">seurTutType</th>
<th align="left">formal</th>
<th align="left">tag</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="left">IL7R</td>
<td align="left">CD4 T cells</td>
<td align="left">CD4-positive helper T cell</td>
<td align="left">CL:0000492</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">CD14, LYZ</td>
<td align="left">CD14+ Monocytes</td>
<td align="left">CD14-positive monocyte</td>
<td align="left">CL:0001054</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">MS4A1</td>
<td align="left">B cells</td>
<td align="left">B cell</td>
<td align="left">CL:0000236</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">CD8A</td>
<td align="left">CD8 T cells</td>
<td align="left">CD8-positive, alpha-beta T cell</td>
<td align="left">CL:0000625</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">FCGR3A, MS4A7</td>
<td align="left">FCGR3A+ Monocytes</td>
<td align="left">monocyte</td>
<td align="left">CL:0000576</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">GNLY, NKG7</td>
<td align="left">NK cells</td>
<td align="left">natural killer cell</td>
<td align="left">CL:0000623</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="left">FCER1A, CST3</td>
<td align="left">Dendritic Cells</td>
<td align="left">dendritic cell</td>
<td align="left">CL:0000451</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="left">PPBP</td>
<td align="left">Megakaryocytes</td>
<td align="left">megakaryocyte</td>
<td align="left">CL:0000556</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="relationships-asserted-in-the-cell-ontology">Relationships asserted in the Cell Ontology<a class="anchor" aria-label="anchor" href="#relationships-asserted-in-the-cell-ontology"></a>
</h4>
<p>Given the informally selected tags in the table above, we can sketch the Cell Ontology graph connecting the associated cell types. The ontoProc package adds functionality to ontologyPlot with <code>make_graphNEL_from_ontology_plot</code>. This allows use of all Rgraphviz and igraph visualization facilities for graphs derived from ontology structures.</p>
<p>Here we display the PBMC cell sets reported in the Seurat tutorial.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vjcitn/ontoProc">ontoProc</a></span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">=</span> <span class="fu"><a href="../reference/getOnto.html">getOnto</a></span><span class="op">(</span><span class="st">"cellOnto"</span>, <span class="st">"2023"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## loading from cache</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/onto_plot2.html">onto_plot2</a></span><span class="op">(</span><span class="va">cl</span>, <span class="va">stab</span><span class="op">$</span><span class="va">tag</span><span class="op">)</span></span></code></pre></div>
<p><img src="ontoProc_files/figure-html/lklklk-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="molecular-features-asserted-in-the-cell-ontology">Molecular features asserted in the Cell Ontology<a class="anchor" aria-label="anchor" href="#molecular-features-asserted-in-the-cell-ontology"></a>
</h4>
<p>The <code>CLfeats</code> function traces relationships and properties from a given Cell Ontology class. Briefly, each class can assert that it is the <code>intersection_of</code> other classes, and <code>has_part</code>, <code>lacks_part</code>, <code>has_plasma_membrane_part</code>, <code>lacks_plasma_membrane_part</code> can be asserted as relationships holding between cell type instances and cell components. The components are often cross-referenced to Protein Ontology or Gene Ontology. When the Protein Ontology component has a synonym for which an HGNC symbol is provided, that symbol is retrieved by <code>CLfeats</code>. Here we obtain the listing for a mature CD1a-positive dermal dendritic cell.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="../reference/CLfeats.html">CLfeats</a></span><span class="op">(</span><span class="va">cl</span>, <span class="st">"CL:0002531"</span>, pr<span class="op">=</span><span class="va">pr</span>, go<span class="op">=</span><span class="va">go</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="10%">
<col width="12%">
<col width="8%">
<col width="47%">
<col width="6%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="left">tag</th>
<th align="left">prtag</th>
<th align="left">cond</th>
<th align="left">entity</th>
<th align="left">SYMBOL</th>
<th align="left">name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CL:0000451</td>
<td align="left">PR:000001002</td>
<td align="left">lacksPMP</td>
<td align="left">CD19 molecule</td>
<td align="left">CD19</td>
<td align="left">dendritic cell</td>
</tr>
<tr class="even">
<td align="left">CL:0000451</td>
<td align="left">PR:000001003</td>
<td align="left">lacksPMP</td>
<td align="left">CD34 molecule</td>
<td align="left">CD34</td>
<td align="left">dendritic cell</td>
</tr>
<tr class="odd">
<td align="left">CL:0000451</td>
<td align="left">PR:000001020</td>
<td align="left">lacksPMP</td>
<td align="left">CD3 epsilon</td>
<td align="left">CD3E</td>
<td align="left">dendritic cell</td>
</tr>
<tr class="even">
<td align="left">CL:0000451</td>
<td align="left">PR:000001024</td>
<td align="left">lacksPMP</td>
<td align="left">neural cell adhesion molecule 1</td>
<td align="left">NCAM1</td>
<td align="left">dendritic cell</td>
</tr>
<tr class="odd">
<td align="left">CL:0000451</td>
<td align="left">PR:000001289</td>
<td align="left">lacksPMP</td>
<td align="left">membrane-spanning 4-domains subfamily A member 1</td>
<td align="left">MS4A1</td>
<td align="left">dendritic cell</td>
</tr>
<tr class="even">
<td align="left">CL:0000451</td>
<td align="left"><a href="GO:0042613" class="uri">GO:0042613</a></td>
<td align="left">hasPart</td>
<td align="left">MHC class II protein complex</td>
<td align="left">NA</td>
<td align="left">dendritic cell</td>
</tr>
<tr class="odd">
<td align="left">CL:0000000</td>
<td align="left"><a href="GO:0005634" class="uri">GO:0005634</a></td>
<td align="left">hasPart</td>
<td align="left">nucleus</td>
<td align="left">NA</td>
<td align="left">cell</td>
</tr>
<tr class="even">
<td align="left">CL:0000000</td>
<td align="left"><a href="GO:0005634" class="uri">GO:0005634</a></td>
<td align="left">hasPart</td>
<td align="left">nucleus</td>
<td align="left">NA</td>
<td align="left">cell</td>
</tr>
</tbody>
</table>
<p>The <code>ctmarks</code> function starts a shiny app that generates tables of this sort for selected cell types.</p>
<div class="figure">
<img src="ctmarks.png" alt="ctmarks snapshot"><p class="caption">ctmarks snapshot</p>
</div>
</div>
<div class="section level4">
<h4 id="mapping-from-gene-presencerole-to-cell-type">Mapping from gene ‘presence/role’ to cell type<a class="anchor" aria-label="anchor" href="#mapping-from-gene-presencerole-to-cell-type"></a>
</h4>
<p>The <code>sym2CellOnto</code> function helps find mention of given gene symbols in properties or parts of cell types.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kable</span><span class="op">(</span><span class="va">sdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="../reference/sym2CellOnto.html">sym2CellOnto</a></span><span class="op">(</span><span class="st">"ITGAM"</span>, <span class="va">cl</span>, <span class="va">pr</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="6%">
<col width="10%">
<col width="12%">
<col width="69%">
</colgroup>
<thead><tr class="header">
<th align="left">sym</th>
<th align="left">cond</th>
<th align="left">cl</th>
<th align="left">type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0000037</td>
<td align="left">hematopoietic stem cell</td>
</tr>
<tr class="even">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0000547</td>
<td align="left">proerythroblast</td>
</tr>
<tr class="odd">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0000553</td>
<td align="left">megakaryocyte progenitor cell</td>
</tr>
<tr class="even">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0000558</td>
<td align="left">reticulocyte</td>
</tr>
<tr class="odd">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0000611</td>
<td align="left">eosinophil progenitor cell</td>
</tr>
<tr class="even">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0000613</td>
<td align="left">basophil progenitor cell</td>
</tr>
<tr class="odd">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0000765</td>
<td align="left">erythroblast</td>
</tr>
<tr class="even">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0000831</td>
<td align="left">mast cell progenitor</td>
</tr>
<tr class="odd">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0000836</td>
<td align="left">promyelocyte</td>
</tr>
<tr class="even">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0000837</td>
<td align="left">hematopoietic multipotent progenitor cell</td>
</tr>
<tr class="odd">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0000872</td>
<td align="left">splenic marginal zone macrophage</td>
</tr>
<tr class="even">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0000941</td>
<td align="left">thymic conventional dendritic cell</td>
</tr>
<tr class="odd">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0000942</td>
<td align="left">thymic plasmacytoid dendritic cell</td>
</tr>
<tr class="even">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0000989</td>
<td align="left">CD11c-low plasmacytoid dendritic cell</td>
</tr>
<tr class="odd">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0000998</td>
<td align="left">CD8_alpha-negative CD11b-negative dendritic cell</td>
</tr>
<tr class="even">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0001000</td>
<td align="left">CD8_alpha-positive CD11b-negative dendritic cell</td>
</tr>
<tr class="odd">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0001029</td>
<td align="left">common dendritic progenitor</td>
</tr>
<tr class="even">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0001060</td>
<td align="left">hematopoietic oligopotent progenitor cell, lineage-negative</td>
</tr>
<tr class="odd">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0001066</td>
<td align="left">erythroid progenitor cell, mammalian</td>
</tr>
<tr class="even">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0002010</td>
<td align="left">pre-conventional dendritic cell</td>
</tr>
<tr class="odd">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0002089</td>
<td align="left">group 2 innate lymphoid cell, mouse</td>
</tr>
<tr class="even">
<td align="left">ITGAM</td>
<td align="left">lacksPMP</td>
<td align="left">CL:0002679</td>
<td align="left">natural helper lymphocyte</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">sdf</span><span class="op">$</span><span class="va">cond</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## lacksPMP </span></span>
<span><span class="co">##       22</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="../reference/sym2CellOnto.html">sym2CellOnto</a></span><span class="op">(</span><span class="st">"FOXP3"</span>, <span class="va">cl</span>, <span class="va">pr</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="7%">
<col width="9%">
<col width="13%">
<col width="69%">
</colgroup>
<thead><tr class="header">
<th align="left">sym</th>
<th align="left">cond</th>
<th align="left">cl</th>
<th align="left">type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">FOXP3</td>
<td align="left">hasPart</td>
<td align="left">CL:0000902</td>
<td align="left">induced T-regulatory cell</td>
</tr>
<tr class="even">
<td align="left">FOXP3</td>
<td align="left">hasPart</td>
<td align="left">CL:0000903</td>
<td align="left">natural T-regulatory cell</td>
</tr>
<tr class="odd">
<td align="left">FOXP3</td>
<td align="left">hasPart</td>
<td align="left">CL:0000919</td>
<td align="left">CD8-positive, CD25-positive, alpha-beta regulatory T cell</td>
</tr>
<tr class="even">
<td align="left">FOXP3</td>
<td align="left">hasPart</td>
<td align="left">CL:0000920</td>
<td align="left">CD8-positive, CD28-negative, alpha-beta regulatory T cell</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="adding-terms-to-ontology_index-structures-to-extend-cell-ontology">Adding terms to ontology_index structures to ‘extend’ Cell Ontology<a class="anchor" aria-label="anchor" href="#adding-terms-to-ontology_index-structures-to-extend-cell-ontology"></a>
</h3>
<p>The task of extending an ontology is partly bureaucratic in nature and depends on a collection of endorsements and updates to centralized information structures. In order to permit experimentation with interfaces and new content that may be quite speculative, we include an approach to combining new ontology ‘terms’ of structure similar to those endorsed in Cell Ontology, to ontologyIndex-based <code>ontology_index</code> instances.</p>
<div class="section level4">
<h4 id="use-case-a-set-of-cell-types-defined-by-diagonal-expression">Use case: a set of cell types defined by “diagonal expression”<a class="anchor" aria-label="anchor" href="#use-case-a-set-of-cell-types-defined-by-diagonal-expression"></a>
</h4>
<p>For a demonstration, we consider the discussion in <span class="citation">Bakken et al. (2017)</span>, of a ‘diagonal’ expression pattern defining a group of novel cell types. A set of genes is identified and cells are distinguised by expressing exactly one gene from the set.</p>
<div class="figure">
<img src="usecaseCyclic.png" alt="Diagonal expression pattern."><p class="caption">Diagonal expression pattern.</p>
</div>
<p>The necessary information is collected in a vector. The vector is the set of genes, the name of element i is the tag to be associated with the type of cell that expresses gene i and does not express any other gene in the set.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CL:X01"</span><span class="op">=</span><span class="st">"GRIK3"</span>, <span class="st">"CL:X02"</span><span class="op">=</span><span class="st">"NTNG1"</span>, <span class="st">"CL:X03"</span><span class="op">=</span><span class="st">"BAGE2"</span>,</span>
<span>             <span class="st">"CL:X04"</span><span class="op">=</span><span class="st">"MC4R"</span>, <span class="st">"CL:X05"</span><span class="op">=</span><span class="st">"PAX6"</span>, <span class="st">"CL:X06"</span><span class="op">=</span><span class="st">"TSPAN12"</span>, </span>
<span>             <span class="st">"CL:X07"</span><span class="op">=</span><span class="st">"hSHISA8"</span>, <span class="st">"CL:X08"</span><span class="op">=</span><span class="st">"SNCG"</span>, <span class="st">"CL:X09"</span><span class="op">=</span><span class="st">"ARHGEF28"</span>, </span>
<span>             <span class="st">"CL:X10"</span><span class="op">=</span><span class="st">"EGF"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="a-data-frame-defining-the-cell-types-and-their-properties">A data.frame defining the cell types and their properties<a class="anchor" aria-label="anchor" href="#a-data-frame-defining-the-cell-types-and-their-properties"></a>
</h4>
<p>The <code>cyclicSigset</code> function produces a data.frame instance connecting cell types with the genes expressed or unexpressed.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cs</span> <span class="op">=</span> <span class="fu"><a href="../reference/cyclicSigset.html">cyclicSigset</a></span><span class="op">(</span><span class="va">sigels</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">cs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 100   3</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">9</span><span class="op">:</span><span class="fl">13</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##        gene   type     cond</span></span>
<span><span class="co">## 1  ARHGEF28 CL:X09   hasExp</span></span>
<span><span class="co">## 2     GRIK3 CL:X09 lacksExp</span></span>
<span><span class="co">## 3     NTNG1 CL:X09 lacksExp</span></span>
<span><span class="co">## 4     BAGE2 CL:X09 lacksExp</span></span>
<span><span class="co">## 5      MC4R CL:X09 lacksExp</span></span>
<span><span class="co">## 9      SNCG CL:X09 lacksExp</span></span>
<span><span class="co">## 10      EGF CL:X09 lacksExp</span></span>
<span><span class="co">## 11    BAGE2 CL:X03   hasExp</span></span>
<span><span class="co">## 12    GRIK3 CL:X03 lacksExp</span></span>
<span><span class="co">## 13    NTNG1 CL:X03 lacksExp</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">cs</span><span class="op">$</span><span class="va">cond</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   hasExp lacksExp </span></span>
<span><span class="co">##       10       90</span></span></code></pre>
<p>It is expected that a tabular layout like this will suffice to handle general situations of cell type definition.</p>
</div>
<div class="section level4">
<h4 id="translating-the-data-frame-elements-to-obo-term-instances">Translating the data.frame elements to OBO Term instances<a class="anchor" aria-label="anchor" href="#translating-the-data-frame-elements-to-obo-term-instances"></a>
</h4>
<p>The most complicated aspect of novel OBO term construction is the proper specifications of relationships with existing ontology components. A prolog that is mostly shared by all terms is generated programmatically for the diagonal pattern task.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">makeIntnProlog</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span> <span class="co"># make type-specific prologs as key-value pairs</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  </span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"id: %s"</span>, <span class="va">id</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"name: %s-expressing cortical layer 1 interneuron, human"</span>, <span class="va">...</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"def: '%s-expressing cortical layer 1 interneuron, human described via RNA-seq observations' [PMID 29322913]"</span>, <span class="va">...</span><span class="op">)</span>,</span>
<span>       <span class="st">"is_a: CL:0000099 ! interneuron"</span>,</span>
<span>       <span class="st">"intersection_of: CL:0000099 ! interneuron"</span><span class="op">)</span></span>
<span> <span class="op">}</span></span></code></pre></div>
<p>The <code>ldfToTerms</code> API uses this to create a set of strings that can be parsed as a term.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pmap</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hasExp"</span><span class="op">=</span><span class="st">"has_expression_of"</span>, lacksExp<span class="op">=</span><span class="st">"lacks_expression_of"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">tms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ldfToTerms.html">ldfToTerms</a></span><span class="op">(</span><span class="va">cs</span>, <span class="va">pmap</span>, <span class="va">sigels</span>, <span class="va">makeIntnProlog</span><span class="op">)</span><span class="op">)</span>, <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "[Term]"                                                                                                        </span></span>
<span><span class="co">##  [2] "id: CL:X01"                                                                                                    </span></span>
<span><span class="co">##  [3] "name: GRIK3-expressing cortical layer 1 interneuron, human"                                                    </span></span>
<span><span class="co">##  [4] "def: 'GRIK3-expressing cortical layer 1 interneuron, human described via RNA-seq observations' [PMID 29322913]"</span></span>
<span><span class="co">##  [5] "is_a: CL:0000099 ! interneuron"                                                                                </span></span>
<span><span class="co">##  [6] "intersection_of: CL:0000099 ! interneuron"                                                                     </span></span>
<span><span class="co">##  [7] "has_expression_of: PR:000008242 ! GRIK3"                                                                       </span></span>
<span><span class="co">##  [8] "lacks_expression_of: PR:000011467 ! NTNG1"                                                                     </span></span>
<span><span class="co">##  [9] "lacks_expression_of: PR:000004625 ! BAGE2"                                                                     </span></span>
<span><span class="co">## [10] "lacks_expression_of: PR:000001237 ! MC4R"                                                                      </span></span>
<span><span class="co">## [11] "lacks_expression_of: PR:000012318 ! PAX6"                                                                      </span></span>
<span><span class="co">## [12] "lacks_expression_of: PR:000016738 ! TSPAN12"                                                                   </span></span>
<span><span class="co">## [13] "lacks_expression_of: PR:B8ZZ34 ! hSHISA8"                                                                      </span></span>
<span><span class="co">## [14] "lacks_expression_of: PR:000015325 ! SNCG"                                                                      </span></span>
<span><span class="co">## [15] "lacks_expression_of: PR:000013942 ! ARHGEF28"                                                                  </span></span>
<span><span class="co">## [16] "lacks_expression_of: PR:000006928 ! EGF"                                                                       </span></span>
<span><span class="co">## [17] "[Term]"                                                                                                        </span></span>
<span><span class="co">## [18] "id: CL:X02"                                                                                                    </span></span>
<span><span class="co">## [19] "name: NTNG1-expressing cortical layer 1 interneuron, human"                                                    </span></span>
<span><span class="co">## [20] "def: 'NTNG1-expressing cortical layer 1 interneuron, human described via RNA-seq observations' [PMID 29322913]"</span></span></code></pre>
<p>The content in tms can then be appended to the content of the Cell Ontology cl.obo as text for import with <code><a href="https://rdrr.io/pkg/ontologyIndex/man/get_ontology.html" class="external-link">ontologyIndex::get_OBO</a></code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="subsetting-singler-resources-using-ontological-mapping">Subsetting SingleR resources using ontological mapping<a class="anchor" aria-label="anchor" href="#subsetting-singler-resources-using-ontological-mapping"></a>
</h3>
<div class="section level4">
<h4 id="a-data-frame-mapping-from-informal-to-formal-terms">A data.frame mapping from informal to formal terms<a class="anchor" aria-label="anchor" href="#a-data-frame-mapping-from-informal-to-formal-terms"></a>
</h4>
<p>Aaron Lun has produced a mapping from informal terms used in the Human Primary Cell Atlas to Cell Ontology tags. We provisionally include a copy of this mapping in ontoProc:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hpca_map</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/hpca.csv"</span>, package<span class="op">=</span><span class="st">"ontoProc"</span><span class="op">)</span>, strings<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">hpca_map</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                          uncontrolled controlled</span></span>
<span><span class="co">## 1        DC:monocyte-derived:immature CL:0000840</span></span>
<span><span class="co">## 2      DC:monocyte-derived:Galectin-1 CL:0000451</span></span>
<span><span class="co">## 3             DC:monocyte-derived:LPS CL:0000451</span></span>
<span><span class="co">## 4                 DC:monocyte-derived CL:0000451</span></span>
<span><span class="co">## 5 Smooth_muscle_cells:bronchial:vit_D CL:0002598</span></span>
<span><span class="co">## 6       Smooth_muscle_cells:bronchial CL:0002598</span></span></code></pre>
<p>We will rename columns of this map for convenience of our <code>bind_formal_tags</code> method.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hpca_map</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"informal"</span>, <span class="st">"formal"</span><span class="op">)</span>  <span class="co"># obligatory for now</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="binding-formal-tags-to-the-hpca-data">Binding formal tags to the HPCA data<a class="anchor" aria-label="anchor" href="#binding-formal-tags-to-the-hpca-data"></a>
</h4>
<p>I am turning this code off for now because there is no standard approach to getting the mapping from the SummarizedExperment yet. When SingleR merges the ‘standardized’ branch, this will come back.</p>
<p>Let’s retrieve the HPCA data from SingleR:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SingleCellExperiment</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/LTLA/celldex" class="external-link">celldex</a></span><span class="op">)</span></span>
<span><span class="va">hpca_sce</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/celldex/man/HumanPrimaryCellAtlasData.html" class="external-link">HumanPrimaryCellAtlasData</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## see ?celldex and browseVignettes('celldex') for documentation</span></span></code></pre>
<pre><code><span><span class="co">## loading from cache</span></span></code></pre>
<pre><code><span><span class="co">## see ?celldex and browseVignettes('celldex') for documentation</span></span></code></pre>
<pre><code><span><span class="co">## loading from cache</span></span></code></pre>
<p>Now bind the formal tags:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hpca_sce</span> <span class="op">=</span> <span class="fu"><a href="../reference/bind_formal_tags.html">bind_formal_tags</a></span><span class="op">(</span><span class="va">hpca_sce</span>, <span class="st">"label.fine"</span>, <span class="va">hpca_map</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">hpca_sce</span><span class="op">$</span><span class="va">label.ont</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 66</span></span></code></pre>
<p>We don’t check for failed mappings:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">xx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">hpca_sce</span><span class="op">$</span><span class="va">label.ont</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">xx</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">hpca_sce</span><span class="op">)</span><span class="op">[</span><span class="va">xx</span>,<span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 2 rows and 3 columns</span></span>
<span><span class="co">##            label.main             label.fine   label.ont</span></span>
<span><span class="co">##           &lt;character&gt;            &lt;character&gt; &lt;character&gt;</span></span>
<span><span class="co">## GSM154081     T_cells T_cell:CCR10+CLA+1,2..          NA</span></span>
<span><span class="co">## GSM154084     T_cells T_cell:CCR10-CLA+1,2..          NA</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">hpca_sce</span><span class="op">$</span><span class="va">label.ont</span> <span class="op">==</span> <span class="st">""</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co"># iPS and BM</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 50</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="subsetting-using-the-class-hierarchy-of-cell-ontology">Subsetting using the class hierarchy of Cell Ontology<a class="anchor" aria-label="anchor" href="#subsetting-using-the-class-hierarchy-of-cell-ontology"></a>
</h4>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cell_onto</span> <span class="op">=</span> <span class="fu">ontoProc</span><span class="fu">::</span><span class="fu"><a href="../reference/getOnto.html">getOnto</a></span><span class="op">(</span><span class="st">"cellOnto"</span>, <span class="st">"2023"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## loading from cache</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hpca_mono</span> <span class="op">=</span> <span class="fu"><a href="../reference/subset_descendants.html">subset_descendants</a></span><span class="op">(</span> <span class="va">hpca_sce</span>, <span class="va">cell_onto</span>, <span class="st">"^monocyte$"</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">hpca_mono</span><span class="op">$</span><span class="va">label.fine</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##                          Monocyte             Monocyte:anti-FcgRIIB </span></span>
<span><span class="co">##                                27                                 2 </span></span>
<span><span class="co">##                    Monocyte:CD14+                    Monocyte:CD16- </span></span>
<span><span class="co">##                                 3                                 7 </span></span>
<span><span class="co">##                    Monocyte:CD16+                    Monocyte:CXCL4 </span></span>
<span><span class="co">##                                 6                                 2 </span></span>
<span><span class="co">##   Monocyte:F._tularensis_novicida           Monocyte:leukotriene_D4 </span></span>
<span><span class="co">##                                 6                                 4 </span></span>
<span><span class="co">##                     Monocyte:MCSF Monocyte:S._typhimurium_flagellin </span></span>
<span><span class="co">##                                 2                                 1</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">hpca_mono</span><span class="op">$</span><span class="va">label.ont</span><span class="op">)</span> <span class="co"># not much diversity</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## CL:0000576 CL:0001054 </span></span>
<span><span class="co">##         57          3</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hpca_tcell</span> <span class="op">=</span> <span class="fu"><a href="../reference/subset_descendants.html">subset_descendants</a></span><span class="op">(</span> <span class="va">hpca_sce</span>, <span class="va">cell_onto</span>, <span class="st">"^T cell$"</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">hpca_tcell</span><span class="op">$</span><span class="va">label.fine</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##                    T_cell:CD4+     T_cell:CD4+_central_memory </span></span>
<span><span class="co">##                             12                              5 </span></span>
<span><span class="co">##    T_cell:CD4+_effector_memory              T_cell:CD4+_Naive </span></span>
<span><span class="co">##                              4                              6 </span></span>
<span><span class="co">##                    T_cell:CD8+     T_cell:CD8+_Central_memory </span></span>
<span><span class="co">##                             16                              3 </span></span>
<span><span class="co">##    T_cell:CD8+_effector_memory T_cell:CD8+_effector_memory_RA </span></span>
<span><span class="co">##                              4                              4 </span></span>
<span><span class="co">##              T_cell:CD8+_naive                T_cell:effector </span></span>
<span><span class="co">##                              4                              4 </span></span>
<span><span class="co">##             T_cell:gamma-delta              T_cell:Treg:Naive </span></span>
<span><span class="co">##                              2                              2</span></span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">hpca_tcell</span><span class="op">$</span><span class="va">label.ont</span><span class="op">)</span> <span class="co"># </span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## CL:0000624 CL:0000625 CL:0000798 CL:0000895 CL:0000900 CL:0000904 CL:0000905 </span></span>
<span><span class="co">##         12         16          2          6          4          5          4 </span></span>
<span><span class="co">## CL:0000907 CL:0000911 CL:0000913 CL:0001062 CL:0002677 </span></span>
<span><span class="co">##          3          4          4          4          2</span></span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">hpca_tcell</span><span class="op">$</span><span class="va">label.ont</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/onto_plot2.html">onto_plot2</a></span><span class="op">(</span><span class="va">cell_onto</span>, <span class="va">uu</span><span class="op">)</span></span></code></pre></div>
<p><img src="ontoProc_files/figure-html/dosub-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="disease-concept-relationships">Disease concept relationships<a class="anchor" aria-label="anchor" href="#disease-concept-relationships"></a>
</h2>
<p>The Experimental Factor Ontology is available and integrates information among diverse ontologies. Here we check on terms likely related to asthma.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ef</span> <span class="op">=</span> <span class="fu"><a href="../reference/getOnto.html">getOnto</a></span><span class="op">(</span><span class="st">"efoOnto"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## loading from cache</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alla</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"sthma"</span>, <span class="va">ef</span><span class="op">$</span><span class="va">name</span>, value<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="va">aa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"obso"</span>, <span class="va">alla</span>, invert<span class="op">=</span><span class="cn">TRUE</span>, value<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/onto_plot2.html">onto_plot2</a></span><span class="op">(</span><span class="va">ef</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">aa</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ontoProc_files/figure-html/lkefo-1.png" width="700"></p>
<p>However, the Human Disease Ontology seems more developed in terms of defining asthma subtypes. We have not integrated that ontology into ontoProc yet, but it can be retrieved conveniently as follows:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hdo_2022_09</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ontologyIndex/man/get_ontology.html" class="external-link">get_OBO</a></span><span class="op">(</span></span>
<span>  <span class="st">"https://github.com/DiseaseOntology/HumanDiseaseOntology/raw/main/src/ontology/HumanDO.obo"</span>, </span>
<span>  extract_tags <span class="op">=</span> <span class="st">"everything"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>With this resource, we can see finer-grained handling of asthma subtyping:</p>
<p><img src="hdoasth.png"></p>
</div>
<div class="section level2">
<h2 id="related-tools">Related tools<a class="anchor" aria-label="anchor" href="#related-tools"></a>
</h2>
<p>Inference on the identities of cells assayed in a single cell transcriptomics experiment can be performed using the Bioconductor <code>celaref</code> package. This package includes a number of reference data resources providing whole-transcriptome profiles of cells of known and unknown type. An approach to systematically structuring data on cell-type signatures, and conducting inference on cell types in new experiments, is provided in the <a href="https://github.com/kevinrue/Hancock" class="external-link">Hancock package</a>, under development.</p>
<p>A CRAN package that is very useful for R programming with ontologies is <code>ontologyIndex</code> <span class="citation">Westbury et al. (2015)</span>. This provides easily used functions for parsing ontologies in the OBO format and for performing basic queries on text fields and list structures.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-Aevermann2018">
<p>Aevermann, Brian D., Mark Novotny, Trygve Bakken, Jeremy A. Miller, Alexander D. Diehl, David Osumi-Sutherland, Roger S. Lasken, Ed S. Lein, and Richard H. Scheuermann. 2018. “Cell type discovery using single-cell transcriptomics: Implications for ontological representation.” <em>Human Molecular Genetics</em> 27 (R1): R40–R47. <a href="https://doi.org/10.1093/hmg/ddy100" class="external-link">https://doi.org/10.1093/hmg/ddy100</a>.</p>
</div>
<div id="ref-Bakken2017">
<p>Bakken, Trygve, Lindsay Cowell, Brian D. Aevermann, Mark Novotny, Rebecca Hodge, Jeremy A. Miller, Alexandra Lee, et al. 2017. “Cell type discovery and representation in the era of high-content single cell phenotyping.” <em>BMC Bioinformatics</em> 18 (Suppl 17). <a href="https://doi.org/10.1186/s12859-017-1977-1" class="external-link">https://doi.org/10.1186/s12859-017-1977-1</a>.</p>
</div>
<div id="ref-butler">
<p>Butler, Andrew, Paul Hoffman, Peter Smibert, Efthymia Papalexi, and Rahul Satija. 2018. “Integrating Single-Cell Transcriptomic Data Across Different Conditions, Technologies, and Species.” <em>Nature Biotechnology</em>. <a href="https://doi.org/10.1038/nbt.4096" class="external-link">https://doi.org/10.1038/nbt.4096</a>.</p>
</div>
<div id="ref-Westbury2015">
<p>Westbury, Sarah K., Ernest Turro, Daniel Greene, Claire Lentaigne, Anne M. Kelly, Tadbir K. Bariana, Ilenia Simeoni, et al. 2015. “Human Phenotype Ontology Annotation and Cluster Analysis to Unravel Genetic Defects in 707 Cases with Unexplained Bleeding and Platelet Disorders.” <em>Genome Medicine</em> 7 (1): 36. <a href="https://doi.org/10.1186/s13073-015-0151-5" class="external-link">https://doi.org/10.1186/s13073-015-0151-5</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Vincent Carey.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
